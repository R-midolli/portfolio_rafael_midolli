<!doctype html>
<html lang="fr" data-theme="dark" data-lang="fr">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description"
    content="Case study ‚Äî ELT Retail Analytics : Pipeline Python + dbt + PostgreSQL, Star Schema, analyse de rentabilit√© par produit et march√©, dashboard Power BI. Portfolio Rafael Midolli." />
  <title>ELT Retail Analytics ‚Äî Case Study</title>
  <meta property="og:title" content="ELT Retail Analytics ‚Äî Case Study" />
  <meta property="og:description"
    content="Pipeline ELT : Python + dbt + PostgreSQL, Star Schema, Power BI. Portfolio Rafael Midolli." />
  <meta property="og:type" content="website" />
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 100 100%27><text y=%27.9em%27 font-size=%2790%27>üìä</text></svg>" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,700;0,800;1,700&family=DM+Sans:wght@400;500;600;700&display=swap"
    rel="stylesheet" />
  <link rel="stylesheet" href="assets/css/project.css" />
  <!-- Google Analytics 4 (GA4) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Z2ST18JFPN"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-Z2ST18JFPN');
  </script>
  <!-- End Google Analytics 4 -->
  <style>
    /* Inline specific UI enhancements for this project */
    .metric-value.highlight {
      background: linear-gradient(135deg, #FF6B6B, #FF8E53);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .metric-value.success {
      background: linear-gradient(135deg, #10B981, #059669);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .metric-value.warning {
      background: linear-gradient(135deg, #F87171, #DC2626);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      color: transparent;
    }

    .insight-card {
      transition: transform 0.3s ease, box-shadow 0.3s ease, border-color 0.3s ease;
      cursor: default;
    }

    .insight-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.2);
    }

    :root[data-theme="dark"] .insight-card:hover {
      border-color: rgba(91, 140, 255, 0.4);
      box-shadow: 0 15px 35px rgba(91, 140, 255, 0.1);
    }

    .architecture-flow {
      display: flex;
      flex-wrap: wrap;
      gap: 1.5rem;
      align-items: center;
      justify-content: space-between;
      margin: 2rem 0;
    }

    .arch-step {
      flex: 1;
      min-width: 140px;
      text-align: center;
      padding: 1.5rem;
      background: var(--surface);
      border: 1px solid var(--border);
      border-radius: 16px;
      transition: all 0.3s ease;
      position: relative;
    }

    .arch-step:hover {
      transform: translateY(-5px);
      border-color: var(--accent);
      background: var(--surface-hover);
    }

    .arch-step:not(:last-child)::after {
      content: '‚Üí';
      position: absolute;
      right: -24px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1.5rem;
      color: var(--text-muted);
      opacity: 0.5;
    }

    @media (max-width: 768px) {
      .arch-step:not(:last-child)::after {
        content: '‚Üì';
        right: 50%;
        bottom: -24px;
        top: auto;
        transform: translateX(50%);
      }

      .architecture-flow {
        flex-direction: column;
      }
    }

    .arch-icon {
      font-size: 2.2rem;
      margin-bottom: 10px;
    }

    .arch-title {
      font-weight: 700;
      color: var(--text);
      margin-bottom: 5px;
    }

    .arch-desc {
      font-size: 0.85rem;
      color: var(--text-muted);
    }
  </style>
</head>

<body>
  <div class="bg-mesh" aria-hidden="true"></div>
  <div class="bg-grid" aria-hidden="true"></div>

  <nav class="nav">
    <a href="index.html#projects" class="logo">
      <span class="logo-ring">RM</span>
      Rafael Midolli
    </a>
    <div class="nav-right">
      <a href="index.html#projects" class="btn-back">
        <span class="lang-fr">‚Üê <span class="back-label">Retour</span></span><span class="lang-en">‚Üê <span
            class="back-label">Back</span></span>
      </a>
      <a href="https://app.powerbi.com/view?r=eyJrIjoiOTJmOGRiODUtYTFmZi00YTkxLWI1NGUtNzczOGIyODI0NTg4IiwidCI6IjdlOTNlMjg2LWIyOWEtNDQ1NC1hNDFhLWU4NDE5ZWM5ZGViNSJ9"
        target="_blank" rel="noopener" class="btn-fullscreen">
        <span class="lang-fr">‚Üó <span class="fs-label">Plein √©cran</span></span><span class="lang-en">‚Üó <span
            class="fs-label">Full&nbsp;screen</span></span>
      </a>
      <button class="theme-toggle" id="themeToggle" type="button" aria-label="Toggle theme">
        <span id="themeIcon">üåô</span>
      </button>
      <button class="lang-toggle" id="langToggle" type="button" aria-label="Toggle language">
        <span id="langIcon">FR</span>
      </button>
    </div>
  </nav>

  <main class="main">
    <div class="case-header">
      <div class="case-label">
        <span class="lang-fr">√âtude de cas Strat√©gique</span>
        <span class="lang-en">Strategic Case Study</span>
      </div>
      <h1 class="case-title">
        <span class="lang-fr">Retail Analytics ‚Äî Diagnostic de Rentabilit√© & Star Schema</span>
        <span class="lang-en">Retail Analytics ‚Äî Profitability Diagnosis & Star Schema</span>
      </h1>
      <div class="case-subtitle">
        <span class="lang-fr">D√©ploiement d'une architecture Data "Scalable" (Python/dbt/PostgreSQL) pour cartographier
          la marge d'ex-distribution sur ¬£17.7M de transactions complexes (B2B/B2C).</span>
        <span class="lang-en">Deployment of a "Scalable" Data Architecture (Python/dbt/PostgreSQL) mapping
          ex-distribution margins across ¬£17.7M of complex B2B/B2C transactions.</span>
      </div>
    </div>

    <div class="info-grid">
      <!-- Problem + Approach -->
      <div class="card">
        <h3>
          <span class="lang-fr">Le D√©ficit H√©t√©rog√®ne UK</span>
          <span class="lang-en">The Heterogeneous UK Deficit</span>
        </h3>
        <p>
          <span class="lang-fr">Un d√©taillant en ligne au Royaume-Uni encaisse une vaste volatilit√© de comportement
            d'achat, brassant du don B2C occasionnel aux commandes en gros d'industriels (B2B Wholesalers). <strong>La
              question d'audit critique:</strong> Comment isoler rapidement ce panachage toxique qui aveugle la gestion
            des stocks de No√´l et p√©nalise les rotations d'inventaires sur 540k flux ?</span>
          <span class="lang-en">A UK online gift retailer absorbs massive purchase behavior volatility, combining ad-hoc
            B2C gifting with heavyweight industrial orders (B2B Wholesalers). <strong>The critical audit
              question:</strong> How to rapidly isolate this toxic mixture that blindsizes holiday inventory planning
            and heavily penalizes SKU rotations across 540k records?</span>
        </p>
        <h3 style="margin-top:20px">
          <span class="lang-fr">Une R√©solution "Modern Data Stack"</span>
          <span class="lang-en">A "Modern Data Stack" Resolution</span>
        </h3>
        <p>
          <span class="lang-fr">Plut√¥t que des requ√™tes manuelles fragiles, la solution repose sur la conception d'un
            pipeline complet ELT. Les logs monolithiques sont d√©vers√©s dans PostgreSQL puis normalis√©s structurellement
            via <strong>dbt</strong> vers un Mod√®le en √âtoile (Star Schema) fiable, s√©parant proprement la
            <code>fact_sales</code> des hi√©rarchies Clients et Produits. Power BI encapsule le tout.</span>
          <span class="lang-en">Rather than depending on brittle manual queries, the resolution rested on executing a
            full ELT pipeline. Monolithic flat logs were ingested straight into PostgreSQL, then structurally reshaped
            via <strong>dbt</strong> toward an enterprise Star Schema model‚Äîgracefully splitting the core
            <code>fact_sales</code> from rigid Client and Product hierarchies.</span>
        </p>

        <!-- Key metrics -->
        <div class="metrics-mini">
          <div class="metric-mini">
            <div class="metric-value">540K</div>
            <div class="metric-label">
              <span class="lang-fr">Lignes de Table Factuelle</span>
              <span class="lang-en">Fact Table Records</span>
            </div>
          </div>
          <div class="metric-mini">
            <div class="metric-value highlight">18%</div>
            <div class="metric-label">
              <span class="lang-fr">H√©morragie (Annulations)</span>
              <span class="lang-en">Cancellation Bleed</span>
            </div>
          </div>
          <div class="metric-mini">
            <div class="metric-value success">¬£17.7M</div>
            <div class="metric-label">
              <span class="lang-fr">Chiffre d'Affaires Audit√©</span>
              <span class="lang-en">Audited Revenue Scope</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Tech Stack + GitHub -->
      <div class="card">
        <h3>
          <span class="lang-fr">Infrastructure de la Plateforme Analytics</span>
          <span class="lang-en">Analytics Platform Infrastructure</span>
        </h3>
        <p>
          <span class="lang-fr">Cr√©ation "from scratch" d'une plateforme unifi√©e visant la tra√ßabilit√©. Couplage
            Python/DBT orchestr√© pour extraire la s√©mantique cach√©e hors d'anciens logs, construisant ainsi le Single
            Source of Truth avant de percer la visualisation via le moteur DAX de Power BI.</span>
          <span class="lang-en">Built a centralized traceability platform purely from scratch. Connected automated
            Python/dbt architectures to aggressively extract business logic from legacy logs‚Äîsecuring a rigorous Single
            Source of Truth before bridging it over to Power BI's DAX engine.</span>
        </p>
        <div class="tech-stack">
          <span class="tech-tag"><span>üêç</span> Python</span>
          <span class="tech-tag"><span>üîß</span> dbt</span>
          <span class="tech-tag"><span>üêò</span> PostgreSQL</span>
          <span class="tech-tag"><span>üìä</span> Power BI</span>
          <span class="tech-tag"><span>üê≥</span> Docker</span>
        </div>
        <a href="https://github.com/R-midolli/elt_retail_analytics" target="_blank" rel="noopener" class="btn-github">
          <svg class="github-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.419-1.305.763-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" />
          </svg>
          <span class="lang-fr">D√©p√¥t GitHub du Projet</span>
          <span class="lang-en">View GitHub Repository</span>
        </a>
      </div>
    </div>

    <!-- Architecture du pipeline ELT -->
    <section class="card">
      <h3>
        <span class="lang-fr">üèóÔ∏è Data Workflow & Gouvernance</span>
        <span class="lang-en">üèóÔ∏è Data Workflow & Governance</span>
      </h3>
      <div class="architecture-flow">
        <div class="arch-step">
          <div class="arch-icon">üì•</div>
          <div class="arch-title">Ingest</div>
          <div class="arch-desc">
            <span class="lang-fr">Python Extract depuis Excel UCI</span>
            <span class="lang-en">Python Extract from UCI Excel</span>
          </div>
        </div>
        <div class="arch-step">
          <div class="arch-icon">üêò</div>
          <div class="arch-title">Load</div>
          <div class="arch-desc">
            <span class="lang-fr">Dockeris√© ‚Äî PostgreSQL</span>
            <span class="lang-en">Dockerized ‚Äî PostgreSQL</span>
          </div>
        </div>
        <div class="arch-step">
          <div class="arch-icon">üîß</div>
          <div class="arch-title">Transform</div>
          <div class="arch-desc">
            <span class="lang-fr">dbt Core (Star Schema)</span>
            <span class="lang-en">dbt Core (Star Schema)</span>
          </div>
        </div>
        <div class="arch-step">
          <div class="arch-icon">üìä</div>
          <div class="arch-title">Serve</div>
          <div class="arch-desc">Power BI</div>
        </div>
      </div>
      <p>
        <span class="lang-fr">
          Abandonner les exports manuels chronophages : l'architecture met en place un v√©ritable mod√®le d√©cisionnel
          <strong>Analytics Engineering</strong>. dbt prend en compte les contraintes, assainissant l'historique et
          b√¢tissant des macros r√©utilisables, ce qui propulse la fluidit√© m√©tier au sein de tables d'analyses pr√™tes
          pour Power BI.
        </span>
        <span class="lang-en">
          Ending the reliance on time-consuming manual exports: the framework established a mature <strong>Analytics
            Engineering</strong> setup. Handling complex referential integrities, dbt cleans the historical garbage
          array into a reusable Star Schema, accelerating commercial fluency directly inside ready-to-consume Power BI
          tables.
        </span>
      </p>
    </section>

    <!-- Key Insights -->
    <section class="insights-section">
      <h2 class="case-title" style="font-size:2rem;margin-bottom:32px">
        <span class="lang-fr">üí° Actionable Data Insights</span>
        <span class="lang-en">üí° Actionable Data Insights</span>
      </h2>

      <div class="insight-card">
        <h4>
          <span class="insight-icon">üìâ</span>
          <span>
            <span class="lang-fr">Faille Op√©rationnelle (18% d'Annulations)</span>
            <span class="lang-en">Operational Leak (18% Cancellation Deficit)</span>
          </span>
        </h4>
        <div class="insight-content">
          <p>
            <span class="lang-fr">
              La num√©risation des factures en retour isol√©es "C" (Cancellation) d√©tonne : un gigantesque <span
                class="insight-highlight warning">gap de ~18% de taux d'√©chec de commande</span>. Cela indique une
              h√©morragie toxique probable caus√©e par des Back-Orders B2B non remplis et des ruptures nettes chez les
              Master-Wholesalers.
            </span>
            <span class="lang-en">
              Isolating and scanning backward traces labeled via "C" Invoices flags a startling <span
                class="insight-highlight warning">~18% system-wide order abort rate</span>. This highlights a toxic
              leakage heavily driven by unfulfilled B2B back-orders or acute out-of-stock scenarios impacting
              Master-Wholesalers.
            </span>
          </p>
          <div class="insight-list">
            <div class="insight-item">
              <span class="lang-fr"><strong>D√©pr√©ciation de marge :</strong> Des annulations massives B2B g√®lent la
                cha√Æne d'approvisionnement et engouffrent le working capital.</span>
              <span class="lang-en"><strong>Margin Depreciation:</strong> Massive B2B rollbacks heavily freeze up the
                supply chain routing, tanking available working capital.</span>
            </div>
            <div class="insight-item">
              <span class="lang-fr"><strong>Quick-Win Recommand√© :</strong> Audit flash de conformit√© logistique sur le
                "Top 20" des r√©f√©rences fr√©quemment renvoy√©es.</span>
              <span class="lang-en"><strong>Recommended Quick-Win:</strong> Implement a flash compliance audit on the
                Top 20 most frequently returned / voided SKUs across the network.</span>
            </div>
          </div>
        </div>
      </div>

      <div class="insight-card">
        <h4>
          <span class="insight-icon">üë•</span>
          <span>
            <span class="lang-fr">Dichotomie GTM : Wholesale (B2B) vs D2C</span>
            <span class="lang-en">GTM Dichotomy: Wholesale (B2B) vs D2C</span>
          </span>
        </h4>
        <div class="insight-content">
          <p>
            <span class="lang-fr">
              Le mix client est parasit√© par la double casquette: des acheteurs Web unitaires (B2C) noy√©s au milieu
              d'acteurs de revente (B2B). En √©clatant la donn√©e <code>Quantity</code>, la mod√©lisation prouve qu'une
              <span class="insight-highlight">√©crasante dominance des volumes d√©pend de la s√©curisation tarifaire des
                grossistes.</span>
            </span>
            <span class="lang-en">
              Customer mix is parasitized by a dual-persona matrix: sporadic unit D2C buyers mixed openly with
              aggressive resale bulk operators (B2B). Exploding the <code>Quantity</code> field proved that an <span
                class="insight-highlight">overwhelming chunk of volume directly correlates to securing rigid pricing
                models with wholesalers.</span>
            </span>
          </p>
          <div class="insight-list">
            <div class="insight-item">
              <span class="lang-fr">Le segment grossiste paie moins cher √† l'unit√© mais impose les vrais seuils de
                rentabilit√©. Relever l√©g√®rement les paliers de fret logistique sur les commandes moyennes.</span>
              <span class="lang-en">The wholesaler segment captures tighter margins but dictates absolute break-even
                thresholds. We must slightly push freight tiers on mid-range B2B orders.</span>
            </div>
          </div>
        </div>
      </div>

      <div class="insight-card">
        <h4>
          <span class="insight-icon">üåç</span>
          <span>
            <span class="lang-fr">Danger Monopolistique R√©gional (UK 80%+)</span>
            <span class="lang-en">Monopolistic Regional Danger (UK at 80%+)</span>
          </span>
        </h4>
        <div class="insight-content">
          <p>
            <span class="lang-fr">
              Le Royaume-Uni vampirise <span class="insight-highlight">√† lui seul 80%+ de la rente globale</span>. Le
              risque d'exposition est flagrant : toute secousse douani√®re ou locale coupe directement le flux de cash.
            </span>
            <span class="lang-en">
              The United Kingdom alone vampires <span class="insight-highlight">upward of 80%+ of the overall revenue
                rent</span>. Risk exposure here is absolutely glaring‚Äîany macro or local regulatory shock immediately
              snipes the operational cash flow.
            </span>
          </p>
          <div class="insight-list">
            <div class="insight-item">
              <span class="lang-fr"><strong>Levier d'Expansion :</strong> Capitaliser sur l'Allemagne et la France en
                d√©clinant une strat√©gie publicitaire agressive, visant la diversification asym√©trique des
                revenus.</span>
              <span class="lang-en"><strong>Expansion Lever:</strong> Capitalize aggressively onto German and French
                penetration with asymmetrical advertising bids to forcefully diversify revenue reliance.</span>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Dashboard Power BI -->
    <section class="card">
      <h3>
        <span class="lang-fr">üìä Executive Dashboard ‚Äî Self-Service BI</span>
        <span class="lang-en">üìä Executive Dashboard ‚Äî Self-Service BI</span>
      </h3>
      <p>
        <span class="lang-fr">
          Outil interactif de type Executive Overview, pens√© pour le Comex. Permet d'isoler en continu les marges
          b√©n√©ficiaires directes face au g√¢chis op√©rationnel (annulations "C" Invoices). Une transition pure de la
          donn√©e brute vers de l'Intelligence Financi√®re.
        </span>
        <span class="lang-en">
          An Executive Overview interactive tool architected for C-Level leadership. Allows continuous isolation of
          direct profit margins vs operational leakage ("C" Invoices). A pure transition of raw relational noise down to
          distilled Financial Intelligence.
        </span>
      </p>
      <div class="powerbi-container">
        <iframe class="powerbi-frame"
          src="https://app.powerbi.com/view?r=eyJrIjoiOTJmOGRiODUtYTFmZi00YTkxLWI1NGUtNzczOGIyODI0NTg4IiwidCI6IjdlOTNlMjg2LWIyOWEtNDQ1NC1hNDFhLWU4NDE5ZWM5ZGViNSJ9"
          allowfullscreen="true">
        </iframe>
      </div>
    </section>

    <!-- Conclusion -->
    <section class="card conclusion conclusion--highlight">
      <h3>
        <span class="lang-fr">üéØ Plan de Gouvernance & Impact Croissance</span>
        <span class="lang-en">üéØ Governance Turnaround & Growth Impact</span>
      </h3>
      <p>
        <span class="lang-fr">
          <strong>1. Stabilisation PNL :</strong> Tuer la ligne de "Long Tail" (R√®gle de Pareto invers√©e), 60% des
          micro-r√©f√©rences (gift-wares) br√ªlent la capacit√© de stock. Il faut se focaliser radicalement sur le Top 15%
          des "Cash Cows".
        </span>
        <span class="lang-en">
          <strong>1. PNL Stabilization:</strong> Murder the "Long Tail" trap (inverted Pareto effect)‚Äîroughly 60% of
          micro-SKUs (assorted gifts) actively burn costly square footage. Force a radical shift towards stocking the
          Top 15% guaranteed 'Cash Cows'.
        </span>
      </p>
      <p>
        <span class="lang-fr">
          <strong>2. Cellule B2B Privil√©gi√©e :</strong> Traiter s√©par√©ment les clients "Wholesalers" afin d'annuler
          prioritairement la crise majeure des 18% de ruptures d'achats via des Key Accounts bien profil√©s.
        </span>
        <span class="lang-en">
          <strong>2. Privileged B2B Taskforce:</strong> Silo out the mega-volume "Wholesaler" nodes to rapidly address
          and dissolve the unacceptable 18% void/cancellation friction using tightly monitored Key Account pipelines.
        </span>
      </p>
    </section>
  </main>

  <script src="assets/js/shared.js"></script>
</body>

</html>